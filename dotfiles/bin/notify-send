#!/usr/bin/env bash

# hijack notify-send notifications
message=$*; [[ $message ]] || message=$(cat)
message=${message//[^[:alnum:][:space:]]}

# hold notification until user is not idle
until [ "$(xprintidle-ng)" -lt 5000 ]; do
    sleep 1
done

# send notification to Emacs
for i in {1..10}
do
    emacsclient -e "(message \"$message\")"
    sleep .2
done
